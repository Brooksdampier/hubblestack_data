#
# This check aims to determine if the PasswordAuthentication setting is set to 'no'.
# If not defined, sshd defaults to 'yes', so it must be explicitly set. This check
# does not exist in the official CIS benchmarks - we'll just have it on the side.
#

grep:
  whitelist:
    sshd_passwdauthentication_no:
      data:
        '*':
        - /etc/ssh/sshd_config:
            match_output: 'PasswordAuthentication no'
            pattern: ^\\s*PasswordAuthentication
            tag: 'sshd-passwordauthentication-no'
      description: Ensure password authentication is disabled in sshd_config
